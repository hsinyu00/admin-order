<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8">
    <meta http-equiv="content-language" content="zh-tw">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=1">
    <title>Filter - THE F2E</title>
    <link rel="stylesheet" href="https://unpkg.com/normalize.css@8.0.0/normalize.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
    <link rel="stylesheet" href="css/filter.css">
    <script src="https://unpkg.com/vue@2.5.16/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>

<body>
    <div class="container" id="app">
        <header>
            <h1 class="logo" href="">Have</h1>
            <input type="text" class="search">
        </header>
        <div class="row">
            <div class="col-12 col-md-3">
                <form>
                    <fieldset class="filter">
                        <h3>選擇地區：</h3>
                        <select v-model="currentZone" @change="filteredByZone">
                            <option :value="null">全部</option>
                            <option v-for="zone in zoneList" :value="zone">{{ zone }}</option>
                        </select>
                    </fieldset>
                    <fieldset class="filter">
                        <label><input type="checkbox">全天候開放</label>
                        <label><input type="checkbox">免費參觀</label>
                    </fieldset>
                </form>
            </div>
            <div class="col-12 col-md-9">
                <p>結果：筆</p>
                <ul class="locations">
                    <li class="media" v-for="item in currentResult">
                        <img class="d-flex align-self-start mr-3" :src="item.Picture1" alt="Generic placeholder image">
                        <div class="media-body">
                            <h2 class="mt-0">{{ item.Name }}</h2>
                            <p>{{ item.Description }}</p>
                            <span>{{ item.Opentime }}</span>
                            <span>{{ item.Ticketinfo }}</span>
                            <span>{{ item.Tel }}</span>
                            <span>{{ item.Add }}</span>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <script>
        let Location = {
            template: ``
        }
        let vm = new Vue({
            el: "#app",
            data: {
                locationList: '',
                zoneList: [
                    '楠梓區',
                    '左營區',
                    '鼓山區',
                    '三民區',
                    '苓雅區',
                    '新興區',
                    '前金區',
                    '鹽埕區',
                    '前鎮區',
                    '旗津區',
                    '小港區'
                ],
                currentZone: '',
                currentResult: []
            },
            computed: {

            },
            methods: {
                filteredByZone() {
                    let result = [];
                    if (!this.currentZone) {
                        result = this.locationList;
                    } else {
                        this.locationList.forEach(obj => {
                            if (obj.Zone === this.currentZone) {
                                result.push(obj);
                            }
                        });
                    }
                    this.currentResult = result;
                }
            },
            components: {
                Location
            },
              mounted() {
                axios.get('https://data.kcg.gov.tw/api/action/datastore_search?resource_id=92290ee5-6e61-456f-80c0-249eae2fcc97')
                    .then(res => {
                        this.locationList = res.data.result.records;
                        this.currentResult =  res.data.result.records;
                    })
                    .catch(error => console.log(error))
            },
        });
    </script>
</body>

</html>